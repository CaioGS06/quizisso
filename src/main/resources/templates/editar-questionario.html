<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">

<head>
  <title>Quizisso - Editar Questionário</title>
  <th:block th:replace="~{fragments/cabecalho :: head}"></th:block>
</head>

<body>
  <th:block th:replace="~{fragments/cabecalho :: cabecalho}"></th:block>

  <main class="conteudo-principal">
    <div class="container-questionario">
      <div class="header-questionario">
        <button class="botao-voltar" onclick="window.location.href='/meus-questionarios'">
          <i class="ti ti-arrow-left"></i>
          Voltar
        </button>
        <div class="info-questionario">
          <input type="text" class="campo-titulo-edicao" th:value="${questionario.titulo}"
            placeholder="Título do Questionário">
          <button class="botao-excluir-questionario" onclick="abrirModalExcluirQuestionario()">
            <i class="ti ti-trash"></i>
            Excluir Questionário
          </button>
        </div>
      </div>

      <form class="formulario-questionario">
        <!-- Loop através dos itens do questionário -->
        <div class="questao-card edicao" th:each="item, iterStat : ${questionario.itens}">
          <div class="questao-header">
            <span class="questao-numero" th:text="'Questão ' + ${iterStat.count}">Questão 1</span>
            <select class="select-tipo-questao">
              <option value="alternativa" th:selected="${item.class.simpleName == 'ItemAlternativa'}">Alternativa
              </option>
              <option value="dissertativa" th:selected="${item.class.simpleName == 'ItemDissertativa'}">Dissertativa
              </option>
            </select>
            <button type="button" class="botao-remover-questao" onclick="removerQuestao(this)">
              <i class="ti ti-x"></i>
            </button>
          </div>
          <input type="text" class="campo-enunciado" th:value="${item.enunciado}" placeholder="Digite o enunciado...">

          <!-- Alternativas (apenas para ItemAlternativa) -->
          <div class="alternativas-edicao" th:if="${item.class.simpleName == 'ItemAlternativa'}">
            <div class="alternativa-edicao" th:each="alternativa, altIterStat : ${item.alternativas}">
              <input type="radio" th:name="'correta' + ${iterStat.count}"
                th:checked="${alternativa == item.respostaCorreta}">
              <input type="text" class="campo-alternativa" th:value="${alternativa}" placeholder="Digite a alternativa">
              <button type="button" class="botao-remover-alternativa" onclick="removerAlternativa(this)">
                <i class="ti ti-x"></i>
              </button>
            </div>
            <button type="button" class="botao-adicionar-alternativa">
              <i class="ti ti-plus"></i>
              Adicionar Alternativa
            </button>
          </div>

          <!-- Gabarito (apenas para ItemDissertativa) -->
          <textarea class="campo-gabarito" th:if="${item.class.simpleName == 'ItemDissertativa'}"
            placeholder="Digite o gabarito/resposta esperada..." rows="4" th:text="${item.gabarito}"></textarea>
        </div>

        <div class="acoes-formulario">
          <button type="button" class="botao-adicionar-questao" onclick="adicionarQuestao()">
            <i class="ti ti-plus"></i>
            Adicionar Questão
          </button>
          <button type="submit" class="botao-salvar">
            <i class="ti ti-device-floppy"></i>
            Salvar Alterações
          </button>
        </div>
      </form>
    </div>
  </main>

  <!-- Modal de Confirmação de Exclusão -->
  <div id="modalExcluirQuestionario" class="modal">
    <div class="modal-conteudo">
      <div class="modal-header">
        <h3>Confirmar Exclusão</h3>
        <button class="botao-fechar-modal" onclick="fecharModalExcluirQuestionario()">
          <i class="ti ti-x"></i>
        </button>
      </div>
      <div class="modal-corpo">
        <p>Tem certeza que deseja excluir este questionário?</p>
        <p class="modal-aviso">Esta ação não pode ser desfeita.</p>
      </div>
      <div class="modal-footer">
        <button class="botao-cancelar" onclick="fecharModalExcluirQuestionario()">Cancelar</button>
        <button class="botao-confirmar-excluir" onclick="confirmarExclusaoQuestionario()">
          <i class="ti ti-trash"></i>
          Excluir
        </button>
      </div>
    </div>
  </div>

  <th:block th:replace="~{fragments/cabecalho :: scripts}"></th:block>
</body>

</html>